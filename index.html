<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mensaje Importante - Presentación Especial</title>
    
    <!-- OPTIMIZACIÓN DE VELOCIDAD (LCP) -->
    <!-- Preconectar a servidores críticos antes de cargar nada -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://www.youtube.com">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fuentes Google (Optimizado con swap para que el texto se vea inmediato) -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap" rel="stylesheet">
    
    <!-- Iconos FontAwesome (VERSIÓN CSS - MÁS RÁPIDA QUE JS) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- MICROSOFT CLARITY TRACKING CODE -->
    <script type="text/javascript">
        (function(c,l,a,r,i,t,y){
            c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
            t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
            y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
        })(window, document, "clarity", "script", "v0t5p4ftcv");
    </script>
    <!-- FIN CLARITY -->

    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f3f4f6;
        }

        /* ----------------------------------------------------
           ESTILOS DEL REPRODUCTOR
           ---------------------------------------------------- */
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* Ratio 16:9 */
            height: 0;
            overflow: hidden;
            background: #000;
            border-radius: 8px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            /* Mejora de LCP: placeholder negro inmediato */
            content-visibility: auto;
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; /* Crucial: Evita controles de YT */
        }

        /* Escudo invisible post-play */
        .click-shield {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10;
            background: transparent;
            display: none;
        }

        /* Overlay Inicial y de Resume */
        .play-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.85); /* Un poco más oscuro para leer textos */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 20;
            transition: opacity 0.3s;
        }
        
        /* Contenedor botones de resume (oculto por defecto) */
        #resumeOptions {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        /* Botón Play gigante (por defecto) */
        #defaultPlayBtn {
            cursor: pointer;
            text-align: center;
        }

        .play-icon {
            font-size: 70px;
            color: white;
            opacity: 0.9;
            animation: pulse 2s infinite;
            margin-bottom: 15px;
        }

        .resume-btn {
            background-color: #ef4444; /* Rojo */
            color: white;
            font-weight: bold;
            padding: 12px 24px;
            border-radius: 50px;
            margin: 8px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            font-size: 16px;
            width: 280px;
            justify-content: center;
            border: 2px solid #ef4444;
        }
        
        .resume-btn:hover {
            background-color: #dc2626;
            transform: scale(1.05);
        }

        .restart-btn {
            background-color: transparent;
            color: #d1d5db;
            border: 2px solid #6b7280;
            font-weight: bold;
            padding: 10px 24px;
            border-radius: 50px;
            margin: 5px;
            cursor: pointer;
            transition: all 0.2s;
            width: 280px;
            text-align: center;
            font-size: 14px;
        }
        .restart-btn:hover {
            border-color: white;
            color: white;
        }

        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
            70% { transform: scale(1); box-shadow: 0 0 0 20px rgba(255, 255, 255, 0); }
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
        }

        /* ----------------------------------------------------
           BARRA DE PROGRESO
           ---------------------------------------------------- */
        .progress-container {
            width: 100%;
            height: 12px;
            background-color: #e5e7eb;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
            overflow: hidden;
            margin-top: -4px;
            position: relative;
            z-index: 10;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #ef4444, #b91c1c);
            width: 0%;
            transition: width 0.5s ease-out;
        }

        /* ----------------------------------------------------
           OFERTA
           ---------------------------------------------------- */
        #offer-section {
            display: none; 
            animation: fadeIn 1.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .price-strike { text-decoration: line-through; color: #ef4444; font-weight: bold; }
        
        .cta-button {
            background: linear-gradient(to bottom, #facc15 0%, #ca8a04 100%);
            border-bottom: 4px solid #a16207;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            transition: all 0.1s;
        }
        .cta-button:active { transform: translateY(3px); border-bottom: 1px solid #a16207; }
        
        .arrows-down { animation: bounce 2s infinite; }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
            40% {transform: translateY(-10px);}
            60% {transform: translateY(-5px);}
        }
        
        /* Indicador de modo test (solo visible si activado) */
        #test-indicator { display: none; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-start pb-10">

    <!-- INDICADOR DE MODO TEST -->
    <div id="test-indicator" class="w-full bg-red-600 text-white text-center py-2 font-bold uppercase tracking-widest animate-pulse text-xs">
        ⚠️ MODO PRUEBA ACTIVO (Oferta en 5s) ⚠️
    </div>

    <header class="w-full max-w-4xl px-4 pt-6 pb-2 text-center">
        <div class="bg-red-600 text-white text-[10px] md:text-xs font-bold uppercase py-1 px-3 inline-block rounded mb-3 tracking-widest shadow-sm">
            Atención: Ver hasta el final
        </div>
        <h1 class="text-2xl md:text-4xl font-black text-gray-900 leading-tight mb-2">
            Descubre el código de 12 palabras que el señor me ha enviado para ti
        </h1>
        <p class="text-gray-600 text-sm md:text-base italic">
            (Asegúrate de tener el sonido activado y no cierres esta página)
        </p>
    </header>

    <main class="w-full max-w-3xl px-4 my-4 flex flex-col items-center">
        
        <div class="w-full relative shadow-2xl rounded-lg">
            <div class="video-wrapper">
                
                <!-- CAPA OVERLAY CON LÓGICA DUAL -->
                <div id="startOverlay" class="play-overlay">
                    
                    <!-- 1. OPCIÓN POR DEFECTO: Play Gigante -->
                    <div id="defaultPlayBtn" onclick="playYouTubeVideo(0)">
                        <i class="fas fa-play-circle play-icon"></i>
                        <p class="text-white font-bold text-lg md:text-xl uppercase tracking-wide">Haga clic para iniciar el video</p>
                        <p class="text-gray-300 text-sm mt-3 font-medium bg-black bg-opacity-50 px-3 py-1 rounded-full inline-block">
                            <i class="fas fa-volume-high mr-2 text-green-400"></i>Sonido Activado
                        </p>
                    </div>

                    <!-- 2. OPCIÓN RESUME: Dos Botones (Oculto inicialmente) -->
                    <div id="resumeOptions">
                        <p class="text-white font-bold text-lg mb-4 text-center">¡Hola de nuevo! <br><span class="text-gray-300 text-sm font-normal">Detectamos que ya estabas viendo el video.</span></p>
                        
                        <button onclick="resumeSavedVideo()" class="resume-btn">
                            <i class="fas fa-history mr-2"></i> Continuar viendo
                        </button>
                        
                        <button onclick="playYouTubeVideo(0)" class="restart-btn">
                            <i class="fas fa-redo mr-2"></i> Ver desde el inicio
                        </button>
                    </div>

                </div>

                <div id="clickShield" class="click-shield"></div>
                <div id="player"></div>
            </div>

            <div class="progress-container">
                <div id="fakeProgressBar" class="progress-bar"></div>
            </div>
        </div>

        <div id="offer-section" class="w-full mt-10 text-center bg-white p-6 md:p-8 rounded-xl shadow-xl border border-gray-100 border-b-4 border-gray-300 relative overflow-hidden">
            <div class="arrows-down text-red-600 text-3xl mb-4"><i class="fas fa-angle-double-down"></i></div>
            <h2 class="text-2xl md:text-3xl font-black text-gray-800 mb-2">¡Oportunidad Única Desbloqueada!</h2>
            <p class="text-gray-600 mb-8 max-w-lg mx-auto text-sm md:text-base leading-relaxed">
                Has demostrado un compromiso real al llegar hasta aquí. Por eso, he habilitado un descuento especial para que accedas hoy mismo.
            </p>
            <div class="bg-yellow-50 rounded-lg p-6 max-w-sm mx-auto mb-8 border border-yellow-200 shadow-sm relative">
                <!-- AHORRO RECALCULADO (37 - 17 = 20) -->
                <div class="absolute -top-3 -right-3 bg-red-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-md transform rotate-3">AHORRAS $20.00</div>
                <div class="flex flex-col items-center justify-center gap-1">
                    <div class="text-gray-400 font-bold text-lg">Precio Regular: <span class="price-strike">$37.00</span></div>
                    <div class="text-5xl font-black text-gray-900 tracking-tighter">
                        <!-- NUEVO PRECIO -->
                        <span class="text-2xl align-top text-gray-500 font-medium">$</span>17<span class="text-2xl align-top text-gray-500 font-medium">.00</span>
                    </div>
                    
                    <!-- NUEVO: PRECIO EN PESOS MEXICANOS Y COLOMBIANOS -->
                    <div class="text-sm font-bold text-gray-500 mt-1">
                        (≈ $340 MXN / $68.000 COP)
                    </div>
                    
                    <div class="text-green-600 font-bold text-sm bg-green-100 px-2 py-0.5 rounded mt-2">OFERTA ACTIVA HOY</div>
                </div>
            </div>

            <a href="https://pay.hotmart.com/V103840516E" target="_blank" class="cta-button w-full md:w-3/4 mx-auto flex items-center justify-center gap-3 text-white font-black text-xl md:text-2xl py-5 px-6 rounded-lg shadow-lg hover:shadow-2xl uppercase tracking-wider group">
                <span>Sí, Quiero Acceder Ahora</span>
                <i class="fas fa-arrow-right group-hover:translate-x-1 transition-transform"></i>
            </a>

            <div class="mt-8 pt-6 border-t border-gray-100">
                <div class="flex flex-wrap justify-center items-center gap-6 opacity-70 grayscale hover:grayscale-0 transition-all duration-300">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" class="h-6" alt="Visa">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg" class="h-6" alt="Mastercard">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg" class="h-6" alt="PayPal">
                </div>
                <div class="text-xs text-gray-400 mt-3 flex justify-center gap-4">
                    <span><i class="fas fa-lock mr-1"></i> SSL Seguro</span>
                    <span><i class="fas fa-check-circle mr-1"></i> Garantía de Satisfacción</span>
                </div>
            </div>
        </div>
    </main>

    <footer class="mt-auto py-6 text-center text-gray-400 text-[10px] w-full max-w-4xl border-t border-gray-200 mx-auto">
        <p>&copy; 2024. Todos los derechos reservados. Este sitio no es parte del sitio web de Facebook o Facebook Inc.</p>
    </footer>

    <script>
        // ==========================================
        //  CONFIGURACIÓN
        // ==========================================
        const YOUTUBE_VIDEO_ID = "VXaaYwwfVE0"; 
        
        // 1. Detección de Parámetro URL para MODO TEST
        // Añade ?test=1 a tu URL para probar la oferta en 5 segundos
        const urlParams = new URLSearchParams(window.location.search);
        const IS_TEST_MODE = urlParams.has('test');

        if (IS_TEST_MODE) {
            document.getElementById('test-indicator').style.display = 'block';
        }

        // Configuración de Tiempo (Segundos)
        // 44 minutos = 2640 segundos
        const TARGET_TIME_SECONDS = IS_TEST_MODE ? 5 : 2640; 
        
        const STORAGE_KEY = 'vsl_video_progress_v1';
        // ==========================================

        var player;
        var interval;
        var offerRevealed = false;
        var savedTime = 0;
        
        const progressBar = document.getElementById('fakeProgressBar');
        const overlay = document.getElementById('startOverlay');
        const defaultBtn = document.getElementById('defaultPlayBtn');
        const resumeOpts = document.getElementById('resumeOptions');
        const shield = document.getElementById('clickShield');
        const offerSection = document.getElementById('offer-section');

        // Backdoor Teclado: Ctrl + Shift + Flecha Derecha
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.shiftKey && event.key === 'ArrowRight') {
                if(player && player.seekTo) {
                    player.seekTo(TARGET_TIME_SECONDS - 2); 
                }
            }
        });

        // Cargar API YouTube
        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        // Hacemos la función global explícitamente
        window.onYouTubeIframeAPIReady = function() {
            try {
                const stored = localStorage.getItem(STORAGE_KEY);
                // Si estamos en MODO TEST, ignoramos el resume para probar el botón rápido
                if (stored && !IS_TEST_MODE) { 
                    savedTime = parseFloat(stored);
                    if (savedTime > 10) {
                        showResumeUI();
                    }
                }
            } catch(e) {}

            player = new YT.Player('player', {
                height: '100%',
                width: '100%',
                videoId: YOUTUBE_VIDEO_ID,
                playerVars: {
                    'playsinline': 1, 'controls': 0, 'disablekb': 1,
                    'fs': 0, 'rel': 0, 'modestbranding': 1, 'iv_load_policy': 3
                },
                events: {
                    'onStateChange': onPlayerStateChange
                }
            });
        };

        window.showResumeUI = function() {
            defaultBtn.style.display = 'none';
            resumeOpts.style.display = 'flex';
        };

        window.resumeSavedVideo = function() {
            playYouTubeVideo(savedTime);
        };

        window.playYouTubeVideo = function(startTime) {
            if(player && player.playVideo) {
                if (startTime === 0) {
                    localStorage.removeItem(STORAGE_KEY);
                }
                player.seekTo(startTime);
                player.playVideo();
                player.unMute();
                
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.style.display = 'none';
                    shield.style.display = 'block';
                }, 300);
                
                startTimerLoop();
            }
        };

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.ENDED) {
                if (!offerRevealed) revealOffer();
                progressBar.style.width = '100%';
                shield.style.display = 'none';
                localStorage.removeItem(STORAGE_KEY);
                clearInterval(interval);
            }
            if (event.data === YT.PlayerState.PAUSED && !offerRevealed) {
                setTimeout(() => { player.playVideo(); }, 100);
            }
        }

        function startTimerLoop() {
            if (interval) clearInterval(interval);

            interval = setInterval(() => {
                if(player && player.getCurrentTime) {
                    var currentTime = player.getCurrentTime();
                    var duration = player.getDuration() || (TARGET_TIME_SECONDS + 300);

                    // Guardar cada 5s (solo si NO es test mode)
                    if (currentTime > 5 && !IS_TEST_MODE) {
                        localStorage.setItem(STORAGE_KEY, currentTime);
                    }

                    if (!offerRevealed && currentTime >= TARGET_TIME_SECONDS) {
                        revealOffer();
                    }

                    if (duration > 0) {
                        const ratio = currentTime / duration;
                        let visualPercentage = Math.pow(ratio, 0.6) * 100;
                        if (visualPercentage > 98 && (player.getPlayerState() !== YT.PlayerState.ENDED)) {
                            visualPercentage = 98 + (ratio * 0.5); 
                        }
                        progressBar.style.width = `${visualPercentage}%`;
                    }
                }
            }, 500); 
        }

        function revealOffer() {
            offerRevealed = true;
            offerSection.style.display = 'block';
            if(window.innerWidth > 768) {
                setTimeout(() => {
                    offerSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }, 100);
            }
        }
    </script>
</body>
</html>
